___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "ActiveCampaign tracking",
  "categories": [
    "ANALYTICS",
    "CONVERSIONS",
    "MARKETING"
  ],
  "brand": {
    "id": "github.com_dowebanalytics",
    "displayName": "DO web analytics",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAEtWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgdGlmZjpJbWFnZUxlbmd0aD0iMjAwIgogICB0aWZmOkltYWdlV2lkdGg9IjIwMCIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iOTYvMSIKICAgdGlmZjpZUmVzb2x1dGlvbj0iOTYvMSIKICAgZXhpZjpQaXhlbFhEaW1lbnNpb249IjIwMCIKICAgZXhpZjpQaXhlbFlEaW1lbnNpb249IjIwMCIKICAgZXhpZjpDb2xvclNwYWNlPSIxIgogICBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIgogICBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiCiAgIHhtcDpNb2RpZnlEYXRlPSIyMDIz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"
  },
  "description": "Create or update contact and sends events to the ActiveCampaign",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "RADIO",
    "name": "type",
    "displayName": "Type",
    "radioItems": [
      {
        "value": "trackEvent",
        "displayValue": "Track event",
        "subParams": []
      },
      {
        "value": "createOrUpdateContact",
        "displayValue": "Create or update contact"
      },
      {
        "value": "createOrUpdateContactTrackEvent",
        "displayValue": "Create or update contact and track event"
      }
    ],
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "email",
    "displayName": "Email",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "contactDataGroup",
    "displayName": "Contact information",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "TEXT",
        "name": "apiUrl",
        "displayName": "API URL",
        "simpleValueType": true,
        "help": "The API is accessed using a base URL that is specific to your account. Your API URL can be found in your account on the My Settings page under the \"Developer\" tab.",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          },
          {
            "type": "REGEX",
            "args": [
              "^(https://).*"
            ],
            "errorMessage": "URL must start with https://"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "apiKey",
        "displayName": "API Key",
        "simpleValueType": true,
        "help": "Your API key can be found in your account on the Settings page under the \"Developer\" tab. Each user in your ActiveCampaign account has their own unique API key.",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "firstName",
        "displayName": "First name",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "lastName",
        "displayName": "Last name",
        "simpleValueType": true
      },
      {
        "type": "TEXT",
        "name": "phone",
        "displayName": "Phone",
        "simpleValueType": true,
        "help": "Example of the phone field value: 7223224241"
      },
      {
        "type": "TEXT",
        "name": "listId",
        "displayName": "List",
        "simpleValueType": true,
        "help": "The ID of the list",
        "valueValidators": [
          {
            "type": "POSITIVE_NUMBER"
          }
        ],
        "valueHint": ""
      },
      {
        "type": "TEXT",
        "name": "tag",
        "displayName": "Tag",
        "simpleValueType": true
      }
    ],
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "createOrUpdateContact",
        "type": "EQUALS"
      },
      {
        "paramName": "type",
        "paramValue": "createOrUpdateContactTrackEvent",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "fieldValuesGroup",
    "displayName": "Contact custom field values",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "fieldValues",
        "displayName": "",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "Field",
            "name": "field",
            "type": "TEXT",
            "valueHint": "%CUSTOM_FIELD%",
            "isUnique": true,
            "valueValidators": []
          },
          {
            "defaultValue": "",
            "displayName": "Value",
            "name": "value",
            "type": "TEXT"
          }
        ],
        "help": ""
      }
    ],
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "createOrUpdateContact",
        "type": "EQUALS"
      },
      {
        "paramName": "type",
        "paramValue": "createOrUpdateContactTrackEvent",
        "type": "EQUALS"
      }
    ],
    "help": "For field name use the personalization tag to specify which field you want updated (eg. %PERS_1%)"
  },
  {
    "type": "GROUP",
    "name": "eventDataGroup",
    "displayName": "Event information",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "TEXT",
        "name": "eventKey",
        "displayName": "Event Key",
        "simpleValueType": true,
        "help": "This value is unique to your ActiveCampaign account and can be found named \"Event Key\" on Settings \u003e Tracking \u003e Event Tracking inside your ActiveCampaign account.",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "actid",
        "displayName": "Actid",
        "simpleValueType": true,
        "help": "This value is unique to your ActiveCampaign account and can be found named \"actid\" on Settings \u003e Tracking \u003e Event Tracking API.",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "event",
        "displayName": "Event name",
        "simpleValueType": true,
        "help": "A value you wish to store for the event.",
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          }
        ]
      },
      {
        "type": "TEXT",
        "name": "eventdata",
        "displayName": "Event Data",
        "simpleValueType": true,
        "help": "A value you wish to store for the event."
      }
    ],
    "enablingConditions": [
      {
        "paramName": "type",
        "paramValue": "trackEvent",
        "type": "EQUALS"
      },
      {
        "paramName": "type",
        "paramValue": "createOrUpdateContactTrackEvent",
        "type": "EQUALS"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

const sendHttpRequest = require('sendHttpRequest');
const encodeUriComponent = require('encodeUriComponent');
const JSON = require('JSON');
const logToConsole = require('logToConsole');
const getContainerVersion = require('getContainerVersion');
const getRequestHeader = require('getRequestHeader');
const getType = require('getType');

const containerVersion = getContainerVersion();
const isDebug = containerVersion.debugMode;
const traceId = isDebug ? getRequestHeader('trace-id') : undefined;

if (
  data.type === 'createOrUpdateContact' ||
  data.type === 'createOrUpdateContactTrackEvent'
) {

  let url =
    'https://' +
    encodeUriComponent(
      data.apiUrl.replace('http://', '').replace('https://', '')
    ) +
    '/admin/api.php?api_action=contact_sync';

  let method = 'POST';

  //logToConsole(JSON.stringify(fieldValues));

  let bodyData =
    'email=' + data.email;

  if (data.firstName) {
    bodyData = bodyData + '&first_name=' + encodeUriComponent(data.firstName);
  }

  if (data.lastName) {
    bodyData = bodyData + '&last_name=' + encodeUriComponent(data.lastName);
  }

  if (data.phone) {
    bodyData = bodyData + '&phone=' + encodeUriComponent(data.phone);
  }

  if (data.tag) {
    bodyData = bodyData + '&tags=' + encodeUriComponent(data.tag);
  }

  if (data.listId) {
    bodyData = bodyData + '&p[' + data.listId + ']=' + encodeUriComponent(data.listId);
  }

  if (data.fieldValues) {

     data.fieldValues.forEach((d) => {
       //bodyData = bodyData + '&';
       //const customFieldName = encodeUriComponent(d.field);
       //const customFieldValue = encodeUriComponent(d.value);
       const customField = '&field[' + d.field + ',0]=' + encodeUriComponent(d.value);
       bodyData = bodyData + customField;
     });
  }

  if (isDebug) {
    logToConsole(
      JSON.stringify({
        Name: 'ActiveCampaign',
        Type: 'Request',
        TraceId: traceId,
        RequestMethod: method,
        RequestUrl: url,
        RequestBody: bodyData,
      })
    );
  }

  sendHttpRequest(
    url,
    (statusCode, headers, body) => {
      if (statusCode >= 200 && statusCode < 300) {
        if (data.type === 'createOrUpdateContactTrackEvent') {
          sendEventRequest();
        } else {
          data.gtmOnSuccess();
        }
      } else {
        data.gtmOnFailure();
      }
    },
    {
      headers: { 'Api-Token': data.apiKey, 'content-type': 'application/x-www-form-urlencoded'},
      method: method, timeout: 5000 },
    //JSON.stringify(bodyData)
      bodyData
  );
}

function sendEventRequest() {
  let url = 'https://trackcmp.net/event';
  let method = 'POST';
  let bodyData =
    'actid=' +
    encodeUriComponent(data.actid) +
    '&key=' +
    encodeUriComponent(data.eventKey) +
    '&event=' +
    encodeUriComponent(data.event) +
    '&visit=' +
    encodeUriComponent('{"email":"' + data.email + '"}');

  if (data.eventdata) {
    bodyData = bodyData + '&eventdata=' + encodeUriComponent(data.eventdata);
  }

  if (isDebug) {
    logToConsole(
      JSON.stringify({
        Name: 'ActiveCampaign',
        Type: 'Request',
        TraceId: traceId,
        RequestMethod: method,
        RequestUrl: url,
        RequestBody: bodyData,
      })
    );
  }

  sendHttpRequest(
    url,
    (statusCode, headers, body) => {
      if (statusCode >= 200 && statusCode < 300) {
        data.gtmOnSuccess();
      } else {
        data.gtmOnFailure();
      }
    },
    {
      headers: { 'content-type': 'application/x-www-form-urlencoded' },
      method: method,
      timeout: 3500,
    },
    bodyData
  );
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_container_data",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_http",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "headerWhitelist",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "headerName"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "trace-id"
                  }
                ]
              }
            ]
          }
        },
        {
          "key": "headersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 03/04/2023, 16:00:00
